<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Konfirmasi PIN | AZâ€¢KO</title>
<style>
  body {margin:0; font-family: Arial; display:flex; justify-content:center; align-items:center; height:100vh; background:#fff;}
  .pin-box {text-align:center; width:90%; max-width:350px;}
  input {width:80%; padding:12px; margin:8px 0; border:1px solid #ccc; border-radius:6px; text-align:center;}
  button {padding:12px 20px; border:none; border-radius:6px; background:#28a745; color:#fff; cursor:pointer;}
</style>
</head>
<body>
<div class="pin-box">
  <h2>Masukkan PIN 6 Digit</h2>
  <input type="password" id="pin" maxlength="6" placeholder="******"><br>
  <button onclick="checkPin()">Masuk</button>
</div>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbw-C9LksZ_UoOMotoaEoNOPg7F_eK09DoexsD8ViF9kls3eod3Kt5uDlvcb-TmV7O-T/exec"; // Ganti dengan Web App Apps Script
const tempUser = localStorage.getItem("tempUser");
if(!tempUser) window.location.href = "index.html";

function checkPin(){
  const pin = document.getElementById("pin").value.trim();
  if(pin.length !== 6) return alert("PIN harus 6 digit!");

  fetch(SCRIPT_URL)
    .then(res => res.json())
    .then(data => {
      const user = data.find(u => u.username === tempUser);
      
      // Fix PIN salah padahal benar
      if(user && user.password.toString().trim() === pin.trim()){
        localStorage.setItem("username", tempUser);
        localStorage.setItem("nickname", user.nickname || tempUser);
        localStorage.setItem("loginTime", Date.now());
        localStorage.removeItem("tempUser");
        window.location.href = "menu.html";
      } else {
        alert("PIN salah!");
      }
    })
    .catch(()=>alert("Gagal menghubungkan ke server."));
}
</script>
</body>
</html>
