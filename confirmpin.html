<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Konfirmasi PIN | AZâ€¢KO</title>
<style>
  body {margin:0; font-family: Arial, sans-serif; display:flex; justify-content:center; align-items:center; height:100vh; background:#fff;}
  .pin-box {text-align:center; width:90%; max-width:350px;}
  input {width:80%; padding:12px; margin:8px 0; border:1px solid #ccc; border-radius:6px; font-size:16px; text-align:center;}
  button {padding:12px 20px; border:none; border-radius:6px; background:#28a745; color:#fff; font-size:16px; cursor:pointer;}
  button:hover {background:#1e7e34;}
</style>
</head>
<body>
<div class="pin-box">
  <h2>Masukkan PIN 6 Digit</h2>
  <input type="password" id="pin" maxlength="6" placeholder="******"><br>
  <button onclick="checkPin()">Masuk</button>
</div>

<script>
const sheetUrl = "https://opensheet.elk.sh/1ummQarznzKNiT3PXnj2rHS-0AWJRmC4wAuj07SjQdkg/username";

// Redirect langsung jika akses langsung tanpa username
const tempUser = localStorage.getItem("tempUser");
if(!tempUser) window.location.href = "index.html";

function checkPin(){
  const pin = document.getElementById("pin").value.trim();
  if(pin.length !== 6) return alert("PIN harus 6 digit!");

  fetch(sheetUrl)
    .then(res=>res.json())
    .then(data=>{
      const user = data.find(u => u.username === tempUser);
      if(user && user.password === pin){
        localStorage.setItem("username", tempUser);
        localStorage.setItem("nickname", user.nickname || tempUser);
        localStorage.setItem("loginTime", Date.now());
        localStorage.removeItem("tempUser");
        window.location.href = "menu.html";
      } else {
        alert("PIN salah!");
      }
    })
    .catch(()=>alert("Gagal menghubungkan ke server."));
}
</script>
</body>
</html>
